
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>11. Applying Functions and Plotting in Pandas &#8212; Data Science with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
    
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/quantecon-book-theme.857ff391aaabaeb8c161d2309c375fe6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">


    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="../../_static/quantecon-book-theme.76bf49d7bbc59738cdb03766fad654af.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/mvlogo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12. Relational Databases and SQL" href="../05/sql%20intro.html" />
    <link rel="prev" title="10. Working with Multiple DataFrames" href="Merge%20and%20Concat%20Dataset.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="" />
<meta name="keywords" content="" />
<meta name="description" content=Applying Functions and Plotting in Pandas  &lt;hr style=&#34;height:0.6px;border:none;color:#666;background-color:#666;&#34; /&gt;   In this section, we will answer the quest />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:title" content="Applying Functions and Plotting in Pandas"/>
<meta name="twitter:description" content="Applying Functions and Plotting in Pandas  &lt;hr style=&#34;height:0.6px;border:none;color:#666;background-color:#666;&#34; /&gt;   In this section, we will answer the quest">
<meta name="twitter:creator" content="@">
<meta name="twitter:image" content="">

<!-- Opengraph tags -->
<meta property="og:title" content="Applying Functions and Plotting in Pandas" />
<meta property="og:type" content="website" />
<meta property="og:url" content="None" />
<meta property="og:image" content="https://raw.githubusercontent.com/Ashray-shetty/bookcopy/main/Multiverse_Logo_RGB_Indigo-02.png" />
<meta property="og:description" content="Applying Functions and Plotting in Pandas  &lt;hr style=&#34;height:0.6px;border:none;color:#666;background-color:#666;&#34; /&gt;   In this section, we will answer the quest" />
<meta property="og:site_name" content="Data Science with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="wrapper">

        <div class="main">

            <div class="page" id=Chapters/04/Pandas apply strings and plotting>

                <div class="page__toc">

                    <div class="inner">

                        
                        <div class="page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply">
   11.1. Apply
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#string-manipulation">
   11.2. String Manipulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping">
   11.3. Grouping
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   11.4. Plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   11.5. Summary
  </a>
 </li>
</ul>

                            <p class="logo">
                                
                                    
                                    <a href=https://community.multiverse.io/><img src="../../_static/mvlogo.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="page__header">

                    <div class="page__header-copy">

                        <p class="page__header-heading"><a href="../../intro.html">Data Science with Python</a></p>

                        <p class="page__header-subheading">Applying Functions and Plotting in Pandas</p>

                    </div>

                    <p class="page__header-authors"></p>

                </div> <!-- .page__header -->



                
                <main class="page__content" role="main">
                    
                    <div>
                        
  <div class="section" id="applying-functions-and-plotting-in-pandas">
<h1><span class="section-number">11. </span>Applying Functions and Plotting in Pandas<a class="headerlink" href="#applying-functions-and-plotting-in-pandas" title="Permalink to this headline">¶</a></h1>
<hr style="height:0.6px;border:none;color:#666;background-color:#666;" />
<p>In this section, we will answer the question:</p>
<p><strong>Can we use the last letter of a name to predict the sex of the baby?</strong></p>
<p>Here’s the Baby Names dataset once again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;babynames.csv&#39;</span><span class="p">)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># the .head() method outputs the first five rows of the DataFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Count</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>F</td>
      <td>9217</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>F</td>
      <td>3860</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Emma</td>
      <td>F</td>
      <td>2587</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Elizabeth</td>
      <td>F</td>
      <td>2549</td>
      <td>1884</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Minnie</td>
      <td>F</td>
      <td>2243</td>
      <td>1884</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Breaking the Problem Down</strong></p>
<p>Although there are many ways to see whether prediction is possible, we will use plotting in this section. We can decompose this question into two steps:</p>
<ol class="simple">
<li><p>Compute the last letter of each name.</p></li>
<li><p>Group by the last letter and sex, aggregating on Count.</p></li>
<li><p>Plot the counts for each sex and letter.</p></li>
</ol>
<div class="section" id="apply">
<h2><span class="section-number">11.1. </span>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h2>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> Series contain an <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method that takes in a function and applies it to each value in the Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          4
1          4
2          4
3          9
4          6
          ..
1891889    5
1891890    5
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To extract the last letter of each name, we can define our own function to pass into <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">last_letter</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">last_letter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          y
1          a
2          a
3          h
4          e
          ..
1891889    s
1891890    y
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="string-manipulation">
<h2><span class="section-number">11.2. </span>String Manipulation<a class="headerlink" href="#string-manipulation" title="Permalink to this headline">¶</a></h2>
<hr>
<p>Although <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> is flexible, it is often faster to use the built-in string manipulation functions in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> when dealing with text data.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides access to string manipulation functions using the <code class="docutils literal notranslate"><span class="pre">.str</span></code> attribute of Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          4
1          4
2          4
3          9
4          6
          ..
1891889    5
1891890    5
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can directly slice out the last letter of each name in a similar way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          y
1          a
2          a
3          h
4          e
          ..
1891889    s
1891890    y
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We suggest looking at the docs for the full list of string methods (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/text.html">link</a>).</p>
<p>We can now add this column of last letters to our <code class="docutils literal notranslate"><span class="pre">baby</span></code> DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baby</span><span class="p">[</span><span class="s1">&#39;Last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Count</th>
      <th>Year</th>
      <th>Last</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>F</td>
      <td>9217</td>
      <td>1884</td>
      <td>y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Anna</td>
      <td>F</td>
      <td>3860</td>
      <td>1884</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Emma</td>
      <td>F</td>
      <td>2587</td>
      <td>1884</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Elizabeth</td>
      <td>F</td>
      <td>2549</td>
      <td>1884</td>
      <td>h</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Minnie</td>
      <td>F</td>
      <td>2243</td>
      <td>1884</td>
      <td>e</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1891889</th>
      <td>Titus</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>s</td>
    </tr>
    <tr>
      <th>1891890</th>
      <td>Toney</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>y</td>
    </tr>
    <tr>
      <th>1891891</th>
      <td>Verna</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1891892</th>
      <td>Winnie</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>e</td>
    </tr>
    <tr>
      <th>1891893</th>
      <td>Winthrop</td>
      <td>M</td>
      <td>5</td>
      <td>1883</td>
      <td>p</td>
    </tr>
  </tbody>
</table>
<p>1891894 rows × 5 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="grouping">
<h2><span class="section-number">11.3. </span>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¶</a></h2>
<hr>
<p>To compute the sex distribution for each last letter, we need to group by both Last and Sex.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shorthand for baby.groupby([&#39;Last&#39;, &#39;Sex&#39;]).agg(np.sum)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count</th>
      <th>Year</th>
    </tr>
    <tr>
      <th>Last</th>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>F</th>
      <td>58079486</td>
      <td>915565667</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1931630</td>
      <td>53566324</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>F</th>
      <td>17376</td>
      <td>1092953</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1435939</td>
      <td>7658923</td>
    </tr>
    <tr>
      <th>c</th>
      <th>F</th>
      <td>30262</td>
      <td>1666288</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">Year</span></code> is also summed up since each non-grouped column is passed into the aggregation function. To avoid this, we can select out the desired columns before calling <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># When lines get long, you can wrap the entire expression in parentheses</span>
<span class="c1"># and insert newlines before each method call</span>
<span class="n">letter_dist</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">baby</span><span class="p">[[</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">letter_dist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count</th>
    </tr>
    <tr>
      <th>Last</th>
      <th>Sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>F</th>
      <td>58079486</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1931630</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>F</th>
      <td>17376</td>
    </tr>
    <tr>
      <th>M</th>
      <td>1435939</td>
    </tr>
    <tr>
      <th>c</th>
      <th>F</th>
      <td>30262</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="plotting">
<h2><span class="section-number">11.4. </span>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides built-in plotting functionality for most basic plots, including bar charts, histograms, line charts, and scatterplots. To make a plot from a DataFrame, use the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use the figsize option to make the plot larger</span>
<span class="n">letter_dist</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last,Sex&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_18_1.png" src="../../_images/Pandas apply strings and plotting_18_1.png" />
</div>
</div>
<p>Although this plot shows the distribution of letters and sexes, the male and female bars are difficult to tell apart. By looking at the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> docs on plotting (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/visualization.html">link</a>) we learn that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> plots one group of bars for row column in the DataFrame, showing one differently colored bar for each column. This means that a pivoted version of the <code class="docutils literal notranslate"><span class="pre">letter_dist</span></code> table will have the right format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letter_pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">baby</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Last&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span>
<span class="p">)</span>
<span class="n">letter_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Sex</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>Last</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>58079486</td>
      <td>1931630</td>
    </tr>
    <tr>
      <th>b</th>
      <td>17376</td>
      <td>1435939</td>
    </tr>
    <tr>
      <th>c</th>
      <td>30262</td>
      <td>1672407</td>
    </tr>
    <tr>
      <th>d</th>
      <td>754233</td>
      <td>16412640</td>
    </tr>
    <tr>
      <th>e</th>
      <td>37421616</td>
      <td>14730974</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letter_pivot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_21_1.png" src="../../_images/Pandas apply strings and plotting_21_1.png" />
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> conveniently generates a legend for us as well. However, this is still difficult to interpret. We plot the counts for each letter and sex which causes some bars to appear very long and others to be almost invisible. We should instead plot the proportion of male and female babies within each last letter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_for_each_letter</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span>

<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Sex</th>
      <th>F</th>
      <th>M</th>
      <th>F prop</th>
      <th>M prop</th>
    </tr>
    <tr>
      <th>Last</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>58079486</td>
      <td>1931630</td>
      <td>0.967812</td>
      <td>0.032188</td>
    </tr>
    <tr>
      <th>b</th>
      <td>17376</td>
      <td>1435939</td>
      <td>0.011956</td>
      <td>0.988044</td>
    </tr>
    <tr>
      <th>c</th>
      <td>30262</td>
      <td>1672407</td>
      <td>0.017773</td>
      <td>0.982227</td>
    </tr>
    <tr>
      <th>d</th>
      <td>754233</td>
      <td>16412640</td>
      <td>0.043935</td>
      <td>0.956065</td>
    </tr>
    <tr>
      <th>e</th>
      <td>37421616</td>
      <td>14730974</td>
      <td>0.717541</td>
      <td>0.282459</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">letter_pivot</span><span class="p">[[</span><span class="s1">&#39;F prop&#39;</span><span class="p">,</span> <span class="s1">&#39;M prop&#39;</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;M prop&#39;</span><span class="p">)</span> <span class="c1"># Sorting orders the plotted bars</span>
 <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Last&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Pandas apply strings and plotting_24_1.png" src="../../_images/Pandas apply strings and plotting_24_1.png" />
</div>
</div>
</div>
<div class="section" id="summary">
<h2><span class="section-number">11.5. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<hr>
<p>We can see that almost all first names that end in ‘p’ are male and names that end in ‘a’ are female! In general, the difference between bar lengths for many letters implies that we can often make a good guess to a person’s sex if we just know the last letter of their first name.</p>
<p>We’ve learned to express the following operations in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Applying a function elementwise</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">series.apply(func)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>String manipulation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">series.str.func()</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Plotting</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.plot.func()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "communitylab/data",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapters/04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="sidebar bd-sidebar inactive persistent" id="site-navigation">

                <div class="sidebar__header">


                    Contents

                </div>

                <nav class="sidebar__nav" id="sidebar-nav" aria-label="Main navigation">
                    <p class="caption">
 <span class="caption-text">
  Programming with Python
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01/intro_python.html">
   1. Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Sequence%2C%20Loops%20and%20Methods.html">
   2. Sequence, Loops and Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/Dictionaries%20and%20Comprehensions.html">
   3. Dictionaries and Comprehensions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Exercise%2001.html">
   4. 📝 Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Solutions%2001.html">
   5. 📃 Solution for Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/Functions%20and%20Exceptions.html">
   6. Functions and Exceptions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data Wrangling with Python
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="NumPy.html">
   7. Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Pandas%20Intro.html">
   8. DataFrames in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Pandas%20grouping%20and%20pivoting.html">
   9. Grouping and Pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Merge%20and%20Concat%20Dataset.html">
   10. Working with Multiple DataFrames
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   11. Applying Functions and Plotting in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05/sql%20intro.html">
   12. Relational Databases and SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06/viz%20intro.html">
   13. Data Visualization
  </a>
 </li>
</ul>

                </nav>

                <div class="sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="toolbar">

            <div class="toolbar__inner">

                <ul class="toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../../intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://community.multiverse.io/" title=""><span class="show-for-sr">Multiverse</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="../../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/communitylab/data/tree/main/Chapters/04/Pandas apply strings and plotting.ipynb" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/communitylab/data/main?urlpath=tree/Chapters/04/Pandas apply strings and plotting.ipynb">BinderHub</option>
                
                    <option value="https://colab.research.google.com/github/communitylab/data/blob/main/Chapters/04/Pandas apply strings and plotting.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/communitylab/data" data-urlpath="tree/data/Chapters/04/Pandas apply strings and plotting.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/communitylab/data/main?urlpath=tree/Chapters/04/Pandas apply strings and plotting.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "Chapters/04/Pandas apply strings and plotting";
                const repoURL = "https://github.com/communitylab/data";
                const urlPath = "tree/data/Chapters/04/Pandas apply strings and plotting.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
    
  </body>
</html>